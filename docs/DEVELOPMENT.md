# Gu√≠a de Desarrollo - Pareto Frontend

## üèóÔ∏è Arquitectura del Proyecto

### Estructura de Carpetas Detallada

```
src/
‚îú‚îÄ‚îÄ assets/                 # Recursos est√°ticos
‚îÇ   ‚îî‚îÄ‚îÄ fonts/             # Fuentes personalizadas
‚îú‚îÄ‚îÄ components/            # Componentes reutilizables
‚îÇ   ‚îú‚îÄ‚îÄ ui/               # Componentes base (Radix UI + Tailwind)
‚îÇ   ‚îú‚îÄ‚îÄ app-sidebar.tsx   # Sidebar principal de la app
‚îÇ   ‚îú‚îÄ‚îÄ Header.tsx        # Header con navegaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ ParetoChart.tsx   # Componente del gr√°fico de Pareto
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ hooks/                # Custom hooks
‚îÇ   ‚îú‚îÄ‚îÄ store.ts          # Hooks de Redux (useAppDispatch, useAppSelector)
‚îÇ   ‚îú‚îÄ‚îÄ useAuth.ts        # L√≥gica de autenticaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ useParetoData.ts  # Manejo de datos de Pareto
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ layouts/              # Layouts de p√°ginas
‚îÇ   ‚îî‚îÄ‚îÄ DashboardLayout.tsx
‚îú‚îÄ‚îÄ lib/                  # Utilidades y helpers
‚îÇ   ‚îî‚îÄ‚îÄ utils.ts          # Funciones de utilidad (cn, clsx)
‚îú‚îÄ‚îÄ pages/                # P√°ginas principales de la aplicaci√≥n
‚îú‚îÄ‚îÄ sections/             # Secciones grandes de p√°ginas
‚îú‚îÄ‚îÄ services/             # Comunicaci√≥n con APIs
‚îú‚îÄ‚îÄ store/                # Redux store y slices
‚îú‚îÄ‚îÄ types/                # Definiciones TypeScript
‚îî‚îÄ‚îÄ config.ts             # Configuraci√≥n global
```

## üîß Configuraci√≥n de Desarrollo

### ESLint y TypeScript

El proyecto usa configuraci√≥n estricta de TypeScript y ESLint:

```typescript
// tsconfig.json configuraciones clave
{
  "compilerOptions": {
    "strict": true,
    "noUncheckedIndexedAccess": true,
    "exactOptionalPropertyTypes": true
  }
}
```

### Alias de Importaci√≥n

```typescript
// Configurado en vite.config.ts
resolve: {
  alias: {
    '@': path.resolve(__dirname, './src'),
  },
}

// Uso en componentes
import { Button } from '@/components/ui/button';
import { useAuth } from '@/hooks/useAuth';
```

## üé® Sistema de Componentes

### Componentes Base (UI)

Todos los componentes UI est√°n basados en Radix UI con estilos Tailwind:

```typescript
// Ejemplo: Button component
interface ButtonProps {
  variant?:
    | 'default'
    | 'destructive'
    | 'outline'
    | 'secondary'
    | 'ghost'
    | 'link'
  size?: 'default' | 'sm' | 'lg' | 'icon'
}
```

### Composici√≥n de Componentes

```typescript
// Patr√≥n usado en el proyecto
const Header = ({ project }: { project: Project | null }) => {
  return (
    <header className="...">
      <Breadcrumb />
      {project && <ProjectActions project={project} />}
    </header>
  )
}
```

## üîÑ Manejo de Estado

### Redux Store Structure

```typescript
// store/index.ts
export const store = configureStore({
  reducer: {
    auth: authSlice.reducer,
    project: projectSlice.reducer,
    problems: problemsSlice.reducer,
  },
})

export type RootState = ReturnType<typeof store.getState>
export type AppDispatch = typeof store.dispatch
```

### Slices Principales

#### Auth Slice

```typescript
interface AuthState {
  user: User | null
  isAuthenticated: boolean
  loading: boolean
}

// Actions principales
;-setUser - setPendingUser - verifySuccess - clearUser
```

#### Project Slice

```typescript
interface ProjectState {
  projects: Project[]
  currentProject: Project | null
  loading: boolean
}
```

## üîê Sistema de Autenticaci√≥n

### Flujo Completo

1. **Registro**:

   ```typescript
   const signup = async (userData: RegisterData) => {
     // 1. Enviar datos de registro
     // 2. Guardar usuario pendiente
     // 3. Navegar a verificaci√≥n
   }
   ```

2. **Verificaci√≥n de Cuenta**:

   ```typescript
   const verifyCode = async (code: string, isActivation: boolean) => {
     // 1. Verificar c√≥digo
     // 2. Activar cuenta o completar login
     // 3. Guardar token y navegar al dashboard
   }
   ```

3. **Login con 2FA**:
   ```typescript
   const login = async (userData: LoginData) => {
     // 1. Validar credenciales
     // 2. Guardar usuario temporal
     // 3. Navegar a verificaci√≥n 2FA
   }
   ```

### Protecci√≥n de Rutas

```typescript
// ProtectedRoute component
const ProtectedRoute = ({ children }: { children: React.ReactNode }) => {
  const { isAuthenticated } = useAuth()
  return isAuthenticated ? children : <Navigate to="/login" />
}
```

## üìä Componente ParetoChart

### Uso de Recharts

```typescript
import {
  BarChart,
  Bar,
  XAxis,
  YAxis,
  CartesianGrid,
  Tooltip,
  Legend,
  ResponsiveContainer,
  Line,
  ComposedChart,
} from 'recharts'

// Estructura de datos esperada
interface ParetoData {
  name: string
  frequency: number
  cumulative: number
  percentage: number
}
```

### Configuraci√≥n del Gr√°fico

```typescript
const ParetoChart = ({ data }: { data: ParetoData[] }) => {
  return (
    <ResponsiveContainer width="100%" height={400}>
      <ComposedChart data={data}>
        <CartesianGrid strokeDasharray="3 3" />
        <XAxis dataKey="name" />
        <YAxis yAxisId="left" />
        <YAxis yAxisId="right" orientation="right" />
        <Tooltip />
        <Legend />
        <Bar yAxisId="left" dataKey="frequency" fill="#f59e0b" />
        <Line
          yAxisId="right"
          type="monotone"
          dataKey="cumulative"
          stroke="#1e3a8a"
        />
      </ComposedChart>
    </ResponsiveContainer>
  )
}
```

## üåê Servicios de API

### Configuraci√≥n de Axios

```typescript
// services/axios.ts
const instance = axios.create({
  baseURL: VITE_BACKEND_URL,
  headers: {
    'Content-Type': 'application/json',
  },
})

// Interceptor para tokens
instance.interceptors.request.use(config => {
  const token = localStorage.getItem('token')
  if (token) {
    config.headers.Authorization = `Bearer ${token}`
  }
  return config
})
```

### Servicios por M√≥dulo

```typescript
// services/auth.ts
export const registerRequest = async (data: RegisterData) => {
  const response = await axios.post<User>('/auth/register', data)
  return response.data
}

// services/project.ts
export const getProjectsRequest = async () => {
  const response = await axios.get<Project[]>('/projects')
  return response.data
}
```

## üéØ Hooks Personalizados

### useAuth Hook

```typescript
export const useAuth = () => {
  const dispatch = useAppDispatch();
  const navigate = useNavigate();

  const signup = async (userData: RegisterData) => { ... };
  const login = async (userData: LoginData) => { ... };
  const verifyCode = async (code: string, verifyActivation: boolean) => { ... };
  const logout = () => { ... };
  const verifyToken = async () => { ... };

  return {
    signup,
    login,
    verifyCode,
    logout,
    isAuthenticated,
    user,
    verifyToken,
  };
};
```

### useParetoData Hook

```typescript
export const useParetoData = () => {
  const [data, setData] = useState<ParetoData[]>([])

  const processData = (rawData: RawProblemData[]) => {
    // L√≥gica para calcular frecuencias y porcentajes acumulativos
    const processed = calculateParetoData(rawData)
    setData(processed)
  }

  return { data, processData }
}
```

## üöÄ Mejores Pr√°cticas

### Tipado TypeScript

```typescript
// Siempre definir interfaces para props
interface ComponentProps {
  title: string
  onAction: (id: string) => void
  optional?: boolean
}

// Usar tipos espec√≠ficos para eventos
const handleSubmit = (event: React.FormEvent<HTMLFormElement>) => {
  event.preventDefault()
}
```

### Gesti√≥n de Formularios

```typescript
// Usar react-hook-form + zod para validaci√≥n
const schema = z.object({
  email: z.string().email('Email inv√°lido'),
  password: z.string().min(8, 'M√≠nimo 8 caracteres'),
})

const form = useForm({
  resolver: zodResolver(schema),
  mode: 'onTouched',
})
```

### Manejo de Errores

```typescript
// Usar toast para notificaciones
import { toast } from 'sonner'

toast.promise(apiCall(), {
  loading: 'Cargando...',
  success: 'Operaci√≥n exitosa',
  error: error => `Error: ${error.message}`,
})
```

## üîß Comandos de Desarrollo

```bash
# Desarrollo
pnpm dev                    # Servidor de desarrollo
pnpm dev --host            # Accesible desde la red

# Build
pnpm build                 # Build de producci√≥n
pnpm preview              # Preview del build

# Linting
pnpm lint                 # Ejecutar ESLint
pnpm lint --fix           # Corregir errores autom√°ticamente

# Dependencias
pnpm add <package>        # Agregar dependencia
pnpm add -D <package>     # Agregar dev dependency
```

## üì± Responsive Design

### Breakpoints Tailwind

```css
/* Configuraci√≥n actual */
sm: '640px'
md: '768px'
lg: '1024px'
xl: '1280px'
2xl: '1536px'
```

### Patrones Responsive

```typescript
// Sidebar responsive
<div className="hidden md:block">
  <AppSidebar />
</div>

// Botones adaptativos
<Button className="w-full sm:w-auto">
  Acci√≥n
</Button>
```

## üß™ Testing (Para implementar)

### Estructura Recomendada

```
src/
‚îú‚îÄ‚îÄ __tests__/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îî‚îÄ‚îÄ test-utils/
    ‚îú‚îÄ‚îÄ setup.ts
    ‚îú‚îÄ‚îÄ mocks/
    ‚îî‚îÄ‚îÄ helpers/
```

### Testing Hooks

```typescript
// Ejemplo para testing de useAuth
import { renderHook } from '@testing-library/react'
import { Provider } from 'react-redux'
import { useAuth } from '@/hooks/useAuth'

test('should handle login correctly', async () => {
  const { result } = renderHook(() => useAuth(), {
    wrapper: ({ children }) => (
      <Provider store={testStore}>{children}</Provider>
    ),
  })

  await act(async () => {
    await result.current.login(mockLoginData)
  })

  expect(result.current.isAuthenticated).toBe(true)
})
```

## üîç Debugging

### Redux DevTools

```typescript
// Ya configurado en store/index.ts
export const store = configureStore({
  reducer: rootReducer,
  devTools: process.env.NODE_ENV !== 'production',
})
```

### Vite DevTools

```bash
# Variables de entorno para debugging
VITE_DEBUG=true
```

## üì¶ Optimizaci√≥n

### Code Splitting

```typescript
// Lazy loading de p√°ginas
const Dashboard = lazy(() => import('@/pages/Dashboard'))
const Login = lazy(() => import('@/pages/Login'))

// Usar con Suspense
;<Suspense fallback={<LoadingSpinner />}>
  <Dashboard />
</Suspense>
```

### Bundle Analysis

```bash
# Analizar el bundle (instalar primero)
pnpm add -D rollup-plugin-visualizer
pnpm build --analyze
```
